<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>garret - tmux</title>
        <link rel="stylesheet" href="https://imjang57.github.io/garret/theme/css/main.css" />
        <link href="https://imjang57.github.io/garret/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="garret Atom Feed" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://imjang57.github.io/garret/">garret </a></h1>
                <nav><ul>
                    <li><a href="https://imjang57.github.io/garret/pages/about.html">About</a></li>
                    <li><a href="https://imjang57.github.io/garret/category/dev-issues.html">dev-issues</a></li>
                    <li><a href="https://imjang57.github.io/garret/category/linux.html">linux</a></li>
                    <li><a href="https://imjang57.github.io/garret/category/mac.html">mac</a></li>
                    <li><a href="https://imjang57.github.io/garret/category/misc.html">misc</a></li>
                    <li><a href="https://imjang57.github.io/garret/category/programming.html">programming</a></li>
                    <li><a href="https://imjang57.github.io/garret/category/tools.html">tools</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="https://imjang57.github.io/garret/tmux-introduction.html">TMUX Introduction</a></h1>
<footer class="post-info">
        <abbr class="published" title="2016-12-31T00:00:00+09:00">
                Published: Sat 31 December 2016
        </abbr>
		<br />
        <abbr class="modified" title="2016-12-31T00:00:00+09:00">
                Updated: Sat 31 December 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://imjang57.github.io/garret/author/imjang57.html">imjang57</a>
        </address>
<p>In <a href="https://imjang57.github.io/garret/category/tools.html">tools</a>.</p>
<p>tags: <a href="https://imjang57.github.io/garret/tag/tmux.html">tmux</a> </p>
</footer><!-- /.post-info --><h1>TMUX (Terminal Multiplexer)</h1>
<p><em>tmux</em> 는 terminal session 을 관리하기 위한 tool 이다. 여러 session 을 생성하여 서로 다른 workspace 를 만들 수 있고, session 을 유지시켜서 server 가 완전히 power off 되지않는다면 workspace 를 유지할 수도 있다.</p>
<p><em>tmux</em> + <em>vim</em> + <em>bash</em> 는 매우 강력한 linux environment 를 제공한다.</p>
<h2>설치</h2>
<ul>
<li>OS X: <code>brew install tmux</code></li>
<li>Ubuntu: <code>apt-get install libevent-dev tmux</code></li>
<li>CentOS: <code>yum install libevent-dev tmux</code></li>
</ul>
<p>Linux 에서는 환경에 따라서 libncurses 모듈이 필요할 수 있다</p>
<h1>tmux basic concepts</h1>
<p><em>tmux</em> 를 이용하기 전에 아래와 같은 개념에 대해 알고 가자.</p>
<ul>
<li><em>session</em> : <em>tmux</em> 실행 단위이다. 하나의 workspace 라고 생각할 수 있다.</li>
<li><em>window</em> : <em>session</em> 내에 생성되는 하나의 terminal</li>
<li><em>pane</em> : terminal 화면을 분할한 단위</li>
<li><em>status bar</em> : 화면 아래부분에 표시되는 <em>session</em> 의 status bar</li>
</ul>
<p>99% 정도되는 대부분의 command 는 <code>ctrl + b</code> 를 누른다음 이어서 command key 를 입력하여 실행된다. 예를 들어 command mode 로 직접 명령어를 입력하고 싶을 때는 <code>ctrl + b, :</code> 와 같이 키를 입력한다. 정확하게는 <code>ctrl + b</code> 를 누른 후 5초 내에 <code>:</code> 를 입력한다. 5초 내에 command key 를 입력하면 된다.</p>
<h2>Session</h2>
<p><em>tmux</em> 를 실행하면 <em>session</em> 이라는 것이 생성된다. <em>session</em> 은 실제 작업이 이루어지는 workspace 이며, <em>tmux</em> 는 이 <em>session</em> 을 관리하는 tool 이다.</p>
<h3>create, rename, exit session</h3>
<p>새로운 session 을 생성:</p>
<div class="highlight"><pre><span></span>$ tmux
$ tmux new-session -s &lt;session name&gt;
$ tmux new -s &lt;session name&gt;
</pre></div>


<p>session name 을 직접 정하지 않았을 경우 숫자가 기본 session name 이 된다. 변경하고 싶으면 아래와 같은 command 를 입력한다.</p>
<div class="highlight"><pre><span></span>$ tmux rename-session -t &lt;target session&gt; &lt;new session name&gt;
</pre></div>


<p>위의 명령에서 <code>tmux</code> 를 제외한 부분(<code>rename-session</code> 부터)을 <em>session</em> 내에서 command mode(<code>ctrl + b, :</code>) 에서 사용해도 된다.
또는 session 내에서 <code>ctrl + b, $</code> 를 입력한다. 그러면 status bar 가 아래처럼 나타난다.</p>
<div class="highlight"><pre><span></span>(rename-session) 0
</pre></div>


<p>기존의 session name 인 0 을 삭제하고 새로운 session name 을 입력한다.</p>
<div class="highlight"><pre><span></span>(rename-session) testsession
</pre></div>


<p>생성된 session 을 종료하고 싶으면 session 내에서 <code>exit</code> 를 실행한다. 또는 <code>ctrl + d</code> 를 입력한다.</p>
<h3>attach and detach session</h3>
<p><em>session</em> 을 실행한 후 이를 유지하고 <em>session</em> 밖으로 나갈 수도 있다. 서버만 내려가지 않는다면 이 <em>session</em> 을 계속 유지시킬 수 있다. 이렇게 동작하는 것을 <em>session</em> 을 detach 한다고 하는데 command mode 에서 <code>detach</code> 를 입력하여 실행할 수 있다. 또는 <code>ctrl + b, d</code> 를 입력해도 된다.</p>
<p>이미 생성된 session 의 목록을 확인하려면 아래 명령을 실행한다.</p>
<div class="highlight"><pre><span></span>$ tmux list-sessions
testsession: <span class="m">1</span> windows <span class="o">(</span>created Thu Dec <span class="m">22</span> 09:31:45 2016<span class="o">)</span> <span class="o">[</span>224x41<span class="o">]</span>
</pre></div>


<p>특정 session 에 다시 접속하려면 아래 명령을 실행한다.</p>
<div class="highlight"><pre><span></span>$ tmux attach-session -t testsession
</pre></div>


<p>위 명령을 아래 처럼 짧게 사용할 수도 있다.</p>
<div class="highlight"><pre><span></span>$ tmux attach -t testsession
</pre></div>


<h2>Window</h2>
<p><em>window</em> 는 <em>session</em> 내에서 나누어지는 공간이다. 일반적으로 인터넷 브라우저나 다른 어플리케이션에서 볼 수 있는 탭과 같은 것이다. <em>session</em> 이라는 workspace 에 여러 <em>window</em> 를 생성하여 한번에 여러가지 일들을 동시에 할 수 있게 된다.</p>
<h3>create, rename, close window</h3>
<p>최초에 <em>session</em> 이 생성되면 무조건 1 개의 <em>window</em> 가 생성된다. 최대 10개까지 생성할 수 있다. 화면 아래에 있는 status bar 에서 현재 <em>window</em> 는 <code>*</code> 가 window name 옆에 표시된다.</p>
<p>현재 <em>session</em> 에서 새로운 <em>window</em> 를 생성하려면 <code>ctrl + b, c</code> 를 입력한다. <em>tmux</em> 로 새로운 <em>session</em> 을 생성하면서 동시에 <em>session</em> 과 <em>window</em> 의 이름을 지정하려면 <code>tmux new-session -s testsession -n testwindow</code> 명령으로 <em>tmux</em> 를 실행하면 된다:</p>
<p>현재 활성화된(<code>*</code> 로 표시된) <em>window</em> 의 name 을 변경하려면 <code>ctrl + b, ,</code> 을 입력한다.</p>
<p>현재 활성화된 <em>window</em> 를 삭제하려면 <code>ctrl + b, &amp;</code> 를 입력하거나 <code>ctrl + d</code> 를 입력한다.</p>
<h3>Move to window</h3>
<p><em>window</em> 사이를 이동하려면 <code>ctrl + b, &lt;window number: 0–9&gt;</code> 를 입력한다. 또는 <code>ctrl + b, n</code> 으로 다음 <em>window</em> 로, <code>ctrl + b, p</code> 로 이전 <em>window</em> 로 이동할 수 있다. 바로 직전에 작업하고 있던 <em>window</em> 로 가려면 <code>ctrl + b, l</code> 을 사용한다. l 의 의미는 last-window 이다.</p>
<p>또 다른 <em>window</em> 를 이동하는 방법은 <code>ctrl + b, w</code> 를 사용하는 방법이다. 이 키를 입력하면 화면에 현재 <em>session</em> 내에 열려 있는 <em>window</em> 들이 list-up 된다. 원하는 <em>window</em> 를 선택하여 바로 이동할 수 있다.</p>
<p><code>ctrl + b, f</code> 를 이용하면 검색을 이용하여 <em>window</em> 를 이동할 수 있다. 검색 결과가 복수이면 해당 <em>window</em> 들이 list-up 된다. 원하는 <em>window</em> 를 선택해서 이동할 수 있다.</p>
<h3>Exit window</h3>
<p>현재 <em>window</em> 를 종료하려면 terminal 에서 <code>exit</code> command 를 실행한다. 또는 <code>ctrl + d</code> 를 입력한다. 모든 <em>window</em> 가 종료되면 <em>session</em> 도 종료된다.</p>
<h2>Pane</h2>
<p><em>pane</em> 은 <em>windows</em> 를 구성하는 화면들이다. <em>windows</em> 는 1개 또는 여러 개의 pane 들로 구성될 수 있다. 때문에 2개의 <em>pane</em> 을 만들어서 <em>window</em> 를 좌우로 나누어 사용할 수도 있다.</p>
<h3>Split</h3>
<p>좌우로 window 분할(Split vertical)하려면 <code>ctrl + b, %</code> 를 입력한다. 또는 command mode 로 <code>split-window -h</code> 를 입력한다.</p>
<p>상하로 window 분할(Split horizontal)하려면 <code>ctrl + b, “</code> 를 입력한다. 또는 command mode 로 <code>split-window -v</code> 를 입력한다.</p>
<h3>Move to pane</h3>
<p><code>ctrl + b, q</code> 를 입력하면 각 <em>pane</em> 에 숫자가 잠시 표시된다. 이 때 원하는 pane 의 숫자를 입력하면 해당 <em>pane</em> 으로 이동한다. 2초 간의 timeout 내에 입력해야 한다.</p>
<p><code>ctrl + b, o</code> 를 입력하면 정해진 순서에 따라 현재 <em>window</em> 에 생성된 <em>pane</em> 들을 차례대로 이동한다.</p>
<p><code>ctrl + b, 방향키(Arrow key)</code> 를 입력하면 인접한 방향의 <em>pane</em> 으로 이동한다.</p>
<h3>Exit pane</h3>
<p>현재 <em>pane</em> 을 종료시키려면 terminal 에서 <code>exit</code> command 를 실행한다. 또는 <code>ctrl + d</code> 를 입력한다.</p>
<p><code>ctrl + b, x</code> 를 입력하면 status bar 에 y/n 을 묻는 prompt 가 표시된다. y 를 선택하면 종료된다.</p>
<p>모든 <em>pane</em> 들이 종료되면 <em>window</em> 도 종료된다.</p>
<h3>Resizing pane</h3>
<p>command mode 에서 명령을 입력하며 <em>pane</em> 의 size 를 조절할 수 있다.</p>
<ul>
<li>왼쪽으로 10 줄이기 : <code>resize-pane -L 10</code></li>
<li>오른쪽으로 10 늘리기 : <code>resize-pane -R 10</code></li>
<li>아래쪽으로 10 늘리기 : <code>resize-pane -D 10</code></li>
<li>위쪽으로 10 늘리기 : <code>resize-pane -U 10</code></li>
</ul>
<h1>Configuration file</h1>
<p>tmux configuration file 은 <code>~/.tmux.conf</code> 이다.</p>
<h1>Key binding</h1>
<p><code>ctrl + b + ?</code> 을 입력하면 현재의 key binding 리스트를 볼 수 있다.</p>
<p>사용자가 원하면 <code>~/.tmux.conf</code> 파일에 key binding 를 설정할 수 있다. 자세한 내용은 tmux manpage 를 참고하자.</p>
<h1>Copy mode</h1>
<p>tmux 를 실행하고 있는 환경에서는 scroll bar 가 없다. 이때 <em>Copy mode</em> 를 사용하면 이전 출력들을 볼 수 있다. 또한 <em>session</em> 안에서 원하는 text 를 copy / paste 할 수 있다.</p>
<p><code>ctrl + b, [</code> 를 입력하면 <em>Copy mode</em> 로 진입한다. <em>pane</em> 의 오른쪽 상단에 buffer 에 저장된 총 line 수가 출력된다. <em>Copy mode</em> 를 종료하고 싶으면 <code>Enter</code> 를 입력하거나 <code>q</code> 를 입력한다.</p>
<p><em>Copy mode</em> 에서 이동은 <code>방향키(Arrow key)</code>, <code>PageUp</code>, <code>PageDown</code> 키들을 사용한다. 만약 vi editor 의 방식으로 이동하고 싶으면 <code>~/.tmux.conf</code> 파일에 <code>setw -g mode-keys vi</code> 를 추가한다. 이 설정을 하면 <code>h</code>, <code>j</code>, <code>k</code>, <code>l</code>, <code>G</code>, <code>g</code>, <code>ctrl + f</code>, <code>ctrl + b</code> 등 vi editor 에서 cursor 이동에 사용되는 key 들을 사용할 수 있다.</p>
<p><em>Copy mode</em> 에서 검색은 <code>?</code> 와 <code>/</code> 를 사용한다. <code>?</code> 또는 <code>/</code> 를 입력하면 <em>pane</em> 왼쪽 아래부분에 <code>Search Up:</code> 이라고 표시된다. 여기에 검색어를 입력한다. <code>?</code> 를 입력하면 위로 검색, <code>/</code> 를 입력하면 아래로 검색한다. 다음, 이전 검색은 <code>N</code>, <code>n</code> 을 입력한다.</p>
<p><em>Copy mode</em> 에서 <code>SPACEBAR</code> 키를 입력하면 <em>Visual mode</em> 가 되며, Text 를 선택할 수 있게 된다. 선택한 Text 를 복사하고 싶으면 <code>Enter</code> 키를 입력한다. <em>Copy mode</em> 에서는 quit 의 의미이지만 <em>Visual mode</em> 에서는 복사와 함꼐 quit 를 수행한다. 복사한 Text 를 붙여넣고 싶다면 <code>ctrl + b, ]</code> 를 입력한다.</p>
<p><code>ctrl + b, :</code> 를 입력하여 command mode 를 실행한 후 <code>list-buffers</code> 를 실행하면 현재 저장된 모든 buffer 들을 볼 수 있다. <code>choose-buffer</code> 를 입력하면 모든 buffer 들의 리스트가 출력되고 원하는 buffer 를 선택할 수 있다. <code>show-buffer</code> 를 입력하면 0번째 buffer 의 내용을 보여준다. 참고로 <code>ctrl + b, ]</code> 는 무조건 0번째 buffer 를 붙여넣기 한다.</p>
<h1>Start with script</h1>
<p><em>session</em> 을 만들고, 화면을 분할하고, 특정 directory 를 생성하고, 패키지를 설치하고, 기타 필요한 작업들을 script 로 작성하여 <em>session</em> 을 생성할 때 한꺼번에 수행되도록 할 수 있다.</p>
<p>tmux initilizing automation script example:</p>
<div class="highlight"><pre><span></span>$ cat start_with_tmux.sh
<span class="c1">#!/bin/bash</span>
<span class="nv">SESSION</span><span class="o">=</span>tmuxtest
<span class="nv">PROJECT_HOME</span><span class="o">=</span><span class="s2">&quot;~/Projects&quot;</span>
<span class="nv">PROJECT_NAME</span><span class="o">=</span><span class="si">${</span><span class="nv">1</span><span class="k">:-</span><span class="nv">node</span><span class="p">-project</span><span class="si">}</span>
<span class="nv">TMUX</span><span class="o">=</span><span class="s2">&quot;tmux&quot;</span>
<span class="c1"># Create new session</span>
<span class="nv">$TMUX</span> new-session -d -s <span class="nv">$SESSION</span>
<span class="c1"># Create new windows</span>
<span class="nv">$TMUX</span> new-window -t <span class="nv">$SESSION</span>:1 -n withindex
<span class="nv">$TMUX</span> new-window -t <span class="nv">$SESSION</span> -n withoutindex
<span class="c1"># Select window</span>
<span class="nv">$TMUX</span> <span class="k">select</span>-window -t withindex
<span class="c1"># Split window</span>
<span class="nv">$TMUX</span> split-window -h
<span class="c1"># Select pane and run commands</span>
<span class="nv">$TMUX</span> <span class="k">select</span>-pane -t 0
<span class="nv">$TMUX</span> send-keys <span class="s2">&quot;mkdir -p </span><span class="nv">$PROJECT_HOME</span><span class="s2">&quot;</span> Enter
<span class="nv">$TMUX</span> send-keys <span class="s2">&quot;cd </span><span class="nv">$PROJECT_HOME</span><span class="s2">&quot;</span> Enter
<span class="nv">$TMUX</span> send-keys <span class="s2">&quot;echo &#39;date&#39; &gt; test.txt&quot;</span> Enter
<span class="nv">$TMUX</span> split-window -v
<span class="c1"># C-m means Carriage Return (one of control characters)</span>
<span class="nv">$TMUX</span> send-keys <span class="s2">&quot;cd </span><span class="nv">$PROJECT_HOME</span><span class="s2">&quot;</span> Enter
<span class="nv">$TMUX</span> send-keys <span class="s2">&quot;tail -f test.txt&quot;</span> C-m
<span class="c1"># Select pane and run commands</span>
<span class="nv">$TMUX</span> <span class="k">select</span>-pane -t 2
<span class="nv">$TMUX</span> send-keys <span class="s2">&quot;ls -ail&quot;</span> Enter
References
http://tmux.github.io/
https://github.com/tmux/tmux
http://haruair.com/blog/2124
http://nodeqa.com/nodejs_ref/99
</pre></div>


<h1>References</h1>
<ul>
<li><a href="https://tmux.github.io">tmux web</a></li>
<li><a href="https://github.com/tmux/tmux">tmux github</a></li>
</ul>                </article>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://imjang57.github.io/garret/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>